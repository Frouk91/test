<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="favicon.ico" type="image/x-icon">
    <title>Formulaire Escalade</title>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@600&display=swap" rel="stylesheet">
    <style>
    :root{
      --primary-color:#FF6B3D;
      --primary-hover:#FF8C66;
      --background-start:#ffe5d0;
      --background-mid:#ffd1a9;
      --background-end:#ffb385;
      --form-background: #fff;
      --form-blur: none;
      --input-border:#f7c6a3;
      --text-color:#222;
      --label-color:#444;
      --input-background:rgba(255,255,255,0.7);
      --focus-outline:#FF8C66;
      --shadow:0 8px 32px 0 rgba(255,107,61,0.10);
      --glass-border:1.5px solid rgba(255,255,255,0.25);
      --btn-gradient:linear-gradient(90deg,#ff9966 0%,#ff5e62 100%);
      --btn-gradient-hover:linear-gradient(90deg,#ff5e62 0%,#ff9966 100%);
      --scroll-thumb: #ffb385cc;
      --scroll-thumb-hover: #ff8c66cc;
      --scroll-track: transparent;
    }
    [data-theme=dark]{
      --primary-color:#6ba7e2;
      --primary-hover:#4a90e2;
      --background-start:#1a2236;
      --background-mid:#273c5a;
      --background-end:#3a4a6b;
      --form-background:rgba(30,36,54,0.97);
      --form-blur:none;
      --input-border:#273c5a;
      --text-color:#e0e6f0;
      --label-color:#b3c7e6;
      --input-background:rgba(40,48,70,0.85);
      --focus-outline:#6ba7e2;
      --shadow:0 8px 32px 0 rgba(106,167,226,0.18);
      --glass-border:1.5px solid rgba(255,255,255,0.10);
      --btn-gradient:linear-gradient(90deg,#273c5a 0%,#6ba7e2 100%);
      --btn-gradient-hover:linear-gradient(90deg,#6ba7e2 0%,#273c5a 100%);
      --scroll-thumb: #6ba7e2cc;
      --scroll-thumb-hover: #4a90e2cc;
      --scroll-track: transparent;
    }
    body{
      font-family:'Inter',Arial,sans-serif;
      background:linear-gradient(120deg,var(--background-start),var(--background-mid),var(--background-end));
      background-size:200% 200%;
      animation:gradientMove 12s ease-in-out infinite;
      min-height:100vh;
      padding:32px 0;
      color:var(--text-color);
      transition:all .3s cubic-bezier(.4,0,.2,1);
      overflow-x: hidden;
    }
    .container{
		width: 95vw;
		max-width: 1800px;
		margin:0 auto;
		display:flex;
		flex-wrap:wrap;
		gap:32px;
		justify-content:center;
	}
@media (min-width: 1800px) {
  .container {
    max-width: 95vw;
  }
}
    #formulaire,#previsualisation{
      flex:1 1 400px;
      padding:32px 28px 32px 28px;
      padding-right:40px;
      border-radius:0px;
      box-shadow:var(--shadow);
      background: var(--form-background);
      backdrop-filter: var(--form-blur);
      border:var(--glass-border);
      transition:all .3s cubic-bezier(.4,0,.2,1);
      overflow-y:auto;
      overflow-x:hidden;
      max-height:90vh;
      margin-bottom:24px;
    }
    #formulaire:hover,#previsualisation:hover{
      transform:scale(1.015);
      box-shadow:0 12px 40px 0 rgba(31,38,135,0.22);
    }
    h2{
      color:var(--text-color);
      text-shadow:0 0 8px var(--primary-color), 0 0 24px var(--primary-hover);
      margin-bottom:18px;
      padding-bottom:8px;
      border-bottom:1px solid var(--input-border);
      font-weight:700;
      letter-spacing:0.01em;
      font-size:1.35rem;
      font-family: 'Orbitron', 'Inter', Arial, sans-serif;
    }
    [data-theme=dark] h2 {
      text-shadow: 0 0 12px #6ba7e2, 0 0 32px #4a90e2;
    }
    .form-group{margin-bottom:18px;}
    label{font-weight:600;color:var(--label-color);display:block;margin-bottom:7px;letter-spacing:0.01em;}
    input[type=text],input[type=date],select,textarea{
      width:100%;padding:12px 14px;border:1.5px solid var(--input-border);border-radius:8px;transition:all .2s;font-size:15px;background-color:var(--input-background);color:var(--text-color);outline:none;box-shadow:0 1px 4px rgba(0,0,0,0.03);}
    input[type=text]:focus,select:focus,textarea:focus,input[type=date]:focus{
      border-color:var(--primary-color);box-shadow:0 0 0 2px var(--primary-color)22;
    }
    .btn-group{display:flex;gap:14px;margin-top:24px;}
    button{
      background:var(--btn-gradient);
      color:#fff;
      padding:8px 14px;
      border:none;
      border-radius:4px;
      cursor:pointer;
      transition:all .18s cubic-bezier(.4,0,.2,1);
      font-weight:600;
      font-size:0.97rem;
      box-shadow:0 2px 8px rgba(0,0,0,0.08);
      position:relative;
      overflow:hidden;
      outline:none;
      display:flex;
      align-items:center;
      justify-content:center;
      gap:8px;
    }
    button:not(.add-id-btn):not(.remove-id-btn) {
      box-shadow: 0 0 0 0 var(--primary-color), 0 2px 8px rgba(0,0,0,0.08);
      transition: box-shadow .3s cubic-bezier(.4,0,.2,1);
    }
    button:not(.add-id-btn):not(.remove-id-btn):hover,
    button:not(.add-id-btn):not(.remove-id-btn):focus {
      box-shadow: 0 0 16px 2px var(--primary-hover), 0 6px 18px rgba(255,107,61,0.10);
    }
    button:hover,button:focus{
      background:var(--btn-gradient-hover);
      transform:translateY(-2px) scale(1.03);
      box-shadow:0 6px 18px rgba(255,107,61,0.10);
    }
    .add-id-btn{
      background:transparent;
      color:var(--primary-color);
      border:1.5px solid var(--primary-color);
      border-radius:8px;
      padding:7px 14px;
      margin-top:8px;
      font-size:14px;
      font-weight:500;
      cursor:pointer;
      transition:all .18s cubic-bezier(.4,0,.2,1);
      box-shadow:none;
      gap:6px;
    }
    .add-id-btn:hover,.add-id-btn:focus{
      background:var(--primary-color)11;
      color:var(--primary-hover);
      border-color:var(--primary-hover);
      transform:translateY(-1px) scale(1.04);
      box-shadow:0 2px 8px rgba(255,107,61,0.08);
    }
    .add-id-btn::before{content:"+";margin-right:5px;font-weight:bold;font-size:15px;}
    .id-container{display:flex;flex-direction:column;gap:8px;}
    .id-input-wrapper{position:relative;display:flex;align-items:center;}
    .id-input-wrapper .id-long-ok,.id-input-wrapper .id-long-nok{padding-right:30px;}
    .remove-id-btn{position:absolute;right:5px;background:none;border:none;color:#bbb;cursor:pointer;font-size:18px;opacity:0;transition:opacity .2s;padding:5px;flex:0 0 auto;}
    .id-input-wrapper:hover .remove-id-btn,.id-input-wrapper:focus-within .remove-id-btn{opacity:1;}
    .remove-id-btn:hover{color:#f44336;background:none;transform:none;}
    #contenu_previsualisation{white-space:pre-wrap;font-family:'Fira Mono',monospace;background-color:var(--input-background);color:var(--text-color);padding:18px;border-radius:10px;flex:1;overflow-y:auto;min-height:300px;margin-bottom:18px;border:1.5px solid var(--input-border);box-shadow:0 1px 6px rgba(0,0,0,0.04);}
    .date-group{display:flex;align-items:center;gap:10px;flex-wrap:wrap;margin-bottom:10px;}
    .date-group span{flex:0 0 auto;}
    .date-group input[type=text]{flex:1;}
    section{margin-bottom:28px;}
    .status-message{padding:10px 14px;border-radius:6px;margin-top:10px;display:none;box-shadow:0 1px 4px rgba(0,0,0,0.04);}
    .success{background-color:#e6f9e6;color:#1a7f3c;border:1.5px solid #b6e6b6;}
    @keyframes gradient{0%{background-position:0% 50%;}50%{background-position:100% 50%;}100%{background-position:0% 50%;}}
    @media (max-width:900px){.container{flex-direction:column;gap:18px;}#formulaire,#previsualisation{width:100%;max-height:none;}}
    .theme-switch-fab{position:fixed;top:30px;right:30px;z-index:200;}
    #theme-toggle-btn{width:54px;height:54px;border:none;border-radius:50%;background:linear-gradient(135deg,#fff 60%,#f7c873 100%);box-shadow:0 4px 16px rgba(0,0,0,0.10);display:flex;align-items:center;justify-content:center;cursor:pointer;transition:background .3s,box-shadow .3s;outline:none;}
    #theme-toggle-btn:focus,#theme-toggle-btn:hover{box-shadow:0 0 0 5px #ffe06699,0 4px 16px rgba(0,0,0,0.18);}
    #theme-toggle-btn:active .theme-icon svg {
  transform: rotate(30deg) scale(1.08);
  transition: transform .2s;
}
    .theme-icon{display:flex;align-items:center;justify-content:center;width:32px;height:32px;transition:transform .4s cubic-bezier(.4,0,.2,1),opacity .3s;}
    .theme-icon svg{width:32px;height:32px;display:block;}
    .theme-icon.sun{color:#f9d923;}.theme-icon.moon{color:#bfcfff;}[data-theme="dark"] #theme-toggle-btn{background:linear-gradient(135deg,#23272f 60%,#7a8bbd 100%);}[data-theme="dark"] .theme-icon.sun{opacity:0;transform:rotate(-90deg) scale(0.7);}[data-theme="dark"] .theme-icon.moon{opacity:1;transform:rotate(0deg) scale(1);}[data-theme="light"] .theme-icon.sun{opacity:1;transform:rotate(0deg) scale(1);}[data-theme="light"] .theme-icon.moon{opacity:0;transform:rotate(90deg) scale(0.7);}
    @media print {body, .container, #formulaire, #previsualisation { background: #fff !important; color: #000 !important; box-shadow: none !important; }.theme-switch-wrapper, .btn-group, .skip-link { display: none !important; }}
    /* Scrollbar moderne, fine, transparente et douce */
    body, #formulaire, #previsualisation, textarea, .container {
      scrollbar-width: thin;
      scrollbar-color: var(--scroll-thumb) var(--scroll-track);
    }
    body::-webkit-scrollbar, #formulaire::-webkit-scrollbar, #previsualisation::-webkit-scrollbar, textarea::-webkit-scrollbar, .container::-webkit-scrollbar {
      width: 8px;
      height: 8px;
      background: var(--scroll-track);
      border-radius: 8px;
    }
    body::-webkit-scrollbar-thumb, #formulaire::-webkit-scrollbar-thumb, #previsualisation::-webkit-scrollbar-thumb, textarea::-webkit-scrollbar-thumb, .container::-webkit-scrollbar-thumb {
      background: var(--scroll-thumb);
      border-radius: 8px;
      min-height: 24px;
      transition: background .2s;
    }
    body::-webkit-scrollbar-thumb:hover, #formulaire::-webkit-scrollbar-thumb:hover, #previsualisation::-webkit-scrollbar-thumb:hover, textarea::-webkit-scrollbar-thumb:hover, .container::-webkit-scrollbar-thumb:hover {
      background: var(--scroll-thumb-hover);
    }
    /* Ajoute ceci dans le style existant, par exemple après .container */
#formulaire, #previsualisation {
  background: rgba(255,255,255,0.18);
  backdrop-filter: blur(12px) saturate(160%);
  border: 1.5px solid rgba(255,255,255,0.25);
  box-shadow: 0 8px 32px 0 rgba(31,38,135,0.18);
}
[data-theme=dark] #formulaire, 
[data-theme=dark] #previsualisation {
  background: rgba(30,36,54,0.65);
  backdrop-filter: blur(14px) saturate(180%);
  border: 1.5px solid rgba(255,255,255,0.10);
}
    /* Ajoute après .theme-icon.sun et .theme-icon.moon */
.theme-icon.sun { color: #222; opacity: 0.92; }
[data-theme="dark"] .theme-icon.sun { color: #bfcfff; opacity: 0.7; }
    
/* Splash Screen Animation */
#splash-screen {
  position: fixed;
  z-index: 9999;
  inset: 0;
  background: radial-gradient(ellipse at center, #1a2236 0%, #000 100%);
  display: flex;
  align-items: center;
  justify-content: center;
  animation: fadeOutSplash 1s ease-out forwards;
  animation-delay: 1s;
}

.splash-content {
  text-align: center;
  color: #6ba7e2;
  font-family: 'Orbitron', sans-serif;
}

.splash-title {
  font-size: 2rem;
  text-shadow: 0 0 10px #4a90e2, 0 0 20px #6ba7e2;
  animation: pulseTitle 1.5s infinite ease-in-out;
}

.scanner {
  width: 200px;
  height: 4px;
  background: linear-gradient(90deg, transparent, #6ba7e2, transparent);
  animation: scanMove 1.2s infinite ease-in-out;
  margin: 30px auto 0;
  border-radius: 2px;
  box-shadow: 0 0 12px #6ba7e2;
}

@keyframes scanMove {
  0% { transform: translateX(-100%); opacity: 0; }
  50% { opacity: 1; }
  100% { transform: translateX(100%); opacity: 0; }
}

@keyframes pulseTitle {
  0%, 100% { text-shadow: 0 0 10px #4a90e2, 0 0 20px #6ba7e2; }
  50% { text-shadow: 0 0 20px #4a90e2, 0 0 40px #6ba7e2; }
}

@keyframes fadeOutSplash {
  to {
    opacity: 0;
    visibility: hidden;
    pointer-events: none;
  }
}

</style>
</head>
<body>

<div id="splash-screen" style="display: flex;">
  <div class="splash-content">
    <div class="scanner"></div>
    <h1 class="splash-title">Chargement...</h1>
  </div>
</div>

    <div class="theme-switch-fab" aria-label="Basculer le mode sombre">
        <button id="theme-toggle-btn" aria-label="Basculer le mode sombre" type="button">
            <span class="theme-icon" aria-hidden="true"></span>
        </button>
    </div>
    <div class="container">
        <form id="formulaire" novalidate>
            <section>
                <h2>Informations générales</h2>
                <div class="form-group">
                    <label for="contexte">Contexte :</label>
                    <select id="contexte" name="contexte">
                        <option value="">Sélectionner</option>
                        <option value="Pack AR">Pack AR</option>
                        <option value="Pack Syndic">Pack Syndic</option>
                        <option value="Pack AP">Pack AP</option>
                        <option value="Règle Hébergée">Règle Hébergée</option>
                        <option value="Lre">Lre</option>
                        <option value="Formulaire Automatisé">Formulaire Automatisé</option>
                        <option value="Formulaire de Publipostage">Formulaire de Publipostage</option>
                        <option value="Répertoire Automatisé">Répertoire Automatisé</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="methode_soumission">Méthode de soumission :</label>
                    <select id="methode_soumission" name="methode_soumission">
                        <option value="">Sélectionner</option>
                        <option value="IV">IV</option>
                        <option value="Document Manager">Document Manager</option>
                        <option value="Formulaire">Formulaire</option>
                        <option value="Esker Loader">Esker Loader</option>
						<option value="Email">Email</option>
                        <option value="SFTP">SFTP</option>
                        <option value="Impress">Impress</option>
                        <option value="Web Service">Web Service</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="environnement">Environnement :</label>
                    <select id="environnement" name="environnement">
                        <option value="">Sélectionner</option>
                        <option value="Tour D">Tour D</option>
                        <option value="Tour G">Tour G</option>
                    </select>
                </div>
            </section>
            <section>
                <h2>Identification du client</h2>
                <div class="form-group">
                    <label for="client">Client :</label>
                    <input type="text" id="client" name="client">
                </div>
                <div class="form-group">
                    <label for="acces_support_utilisateur">Accès support Utilisateur :</label>
                    <input type="text" id="acces_support_utilisateur" name="acces_support_utilisateur">
                </div>
                <div class="form-group">
                    <label for="acces_service_user">Accès Service User :</label>
                    <input type="text" id="acces_service_user" name="acces_service_user">
                </div>
            </section>
            <section>
                <h2>Anomalie</h2>
                <div class="form-group">
                    <label for="description_problematique">Description de la problématique :</label>
                    <textarea id="description_problematique" name="description_problematique" rows="4"></textarea>
                </div>
                <div class="form-group">
                    <label for="besoin_client">Besoin client :</label>
                    <textarea id="besoin_client" name="besoin_client" rows="4"></textarea>
                </div>
                <div class="date-group">
                    <label for="date_apparition_probleme">Date d'apparition du problème :</label><br>
                    <input type="date" id="date_apparition_probleme" name="date_apparition_probleme">
                    <span style="margin: 0 10px;">ou</span>
                    <input type="text" id="date_apparition_probleme_libre" name="date_apparition_probleme_libre" placeholder="Ex : depuis la dernière mise à jour">
                </div>
                <div class="form-group">
                    <label>ID Long OK :</label>
                    <div id="id_long_ok_container" class="id-container">
                        <div class="id-input-wrapper">
                            <input type="text" name="id_long_ok[]" class="id-long-ok">
                            <button type="button" class="remove-id-btn" onclick="supprimerChamp(this)" title="Supprimer">×</button>
                        </div>
                    </div>
                    <button type="button" onclick="ajouterChamp('ok')" class="add-id-btn">Ajouter un ID</button>
                </div>
                <div class="form-group">
                    <label>ID Long NOK :</label>
                    <div id="id_long_nok_container" class="id-container">
                        <div class="id-input-wrapper">
                            <input type="text" name="id_long_nok[]" class="id-long-nok">
                            <button type="button" class="remove-id-btn" onclick="supprimerChamp(this)" title="Supprimer">×</button>
                        </div>
                    </div>
                    <button type="button" onclick="ajouterChamp('nok')" class="add-id-btn">Ajouter un ID</button>
                </div>
            </section>
            <section>
                <h2>Analyse et Actions</h2>
                <div class="form-group">
                    <label for="analyse_actions">Analyse et actions menées :</label>
                    <textarea id="analyse_actions" name="analyse_actions" rows="4"></textarea>
                </div>
            </section>
            <div class="btn-group">
                <button type="button" onclick="previsualiser()">Prévisualiser</button>
                <button type="button" onclick="reinitialiserFormulaire()">Réinitialiser</button>
            </div>
        </form>
        <div id="previsualisation">
            <h2>Prévisualisation des données saisies</h2>
            <pre id="contenu_previsualisation">Remplissez le formulaire et cliquez sur "Prévisualiser" pour voir le résultat ici.</pre>
            <div id="copy_status" class="status-message success">Contenu copié !</div>
            <div class="btn-group">
                <button onclick="copierDansPressePapier()">Copier dans le presse-papiers</button>
                <button onclick="genererFichier()">Télécharger le fichier TXT</button>
            </div>
        </div>
    </div>
    <script>


// JS minifié et robuste pour le bouton de thème flottant
(function(){
function setThemeIcon(themeBtn){
  if(!themeBtn) return;
  const icon=themeBtn.querySelector('.theme-icon');
  const theme=document.documentElement.getAttribute('data-theme')||'light';
  icon.innerHTML = theme === 'dark'
  ? `<svg class="moon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1 1 11.21 3a7 7 0 0 0 9.79 9.79z"/></svg>`
  : `<svg class="sun" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.1" stroke-linecap="round" stroke-linejoin="round">
      <circle cx="12" cy="12" r="5"/>
      <g>
        <line x1="12" y1="1.5" x2="12" y2="4"/>
        <line x1="12" y1="20" x2="12" y2="22.5"/>
        <line x1="4" y1="12" x2="1.5" y2="12"/>
        <line x1="20" y1="12" x2="22.5" y2="12"/>
        <line x1="5.64" y1="5.64" x2="4.1" y2="4.1"/>
        <line x1="18.36" y1="18.36" x2="19.9" y2="19.9"/>
        <line x1="5.64" y1="18.36" x2="4.1" y2="19.9"/>
        <line x1="18.36" y1="5.64" x2="19.9" y2="4.1"/>
      </g>
    </svg>`;
icon.className = 'theme-icon ' + (theme === 'dark' ? 'moon' : 'sun');
}
function toggleTheme(themeBtn){
  const isDark=document.documentElement.getAttribute('data-theme')==='dark';
  document.documentElement.setAttribute('data-theme',isDark?'light':'dark');
  localStorage.setItem('theme',isDark?'light':'dark');
  setThemeIcon(themeBtn);
}
function initThemeBtn(){
  const themeBtn=document.getElementById('theme-toggle-btn');
  if(!themeBtn) return;
  // Appliquer le thème sauvegardé au chargement
  const currentTheme=localStorage.getItem('theme');
  if(currentTheme){
    document.documentElement.setAttribute('data-theme',currentTheme);
  }
  setThemeIcon(themeBtn);
  themeBtn.addEventListener('click',function(){toggleTheme(themeBtn);});
}
if(document.readyState==='loading'){
  document.addEventListener('DOMContentLoaded',initThemeBtn);
}else{
  initThemeBtn();
}
// ... reste du code (prévisualisation, etc.) ...
window.previsualiser=function(){
  window.scrollTo({top:0,behavior:'smooth'});
  const qs=(s)=>document.querySelector(s),qsa=(s)=>document.querySelectorAll(s);
  const contexte=qs('#contexte').value,
        methodeSoumission=qs('#methode_soumission').value,
        environnement=qs('#environnement').value,
        client=qs('#client').value,
        accesSupportUtilisateur=qs('#acces_support_utilisateur').value,
        accesServiceUser=qs('#acces_service_user').value,
        descriptionProblematique=qs('#description_problematique').value,
        besoinClient=qs('#besoin_client').value,
        dateApparitionProbleme=qs('#date_apparition_probleme').value,
        dateApparitionProblemeLibre=qs('#date_apparition_probleme_libre').value,
        analyseActions=qs('#analyse_actions').value,
        idLongOkArray=Array.from(qsa('.id-long-ok')).map(i=>i.value.trim()).filter(v=>v!==''),
        idLongNokArray=Array.from(qsa('.id-long-nok')).map(i=>i.value.trim()).filter(v=>v!=='');
  let contenu='== Informations générales ==\n\n';
  if(contexte)contenu+=`Contexte : ${contexte}\n`;
  if(methodeSoumission)contenu+=`Méthode de soumission : ${methodeSoumission}\n`;
  if(environnement)contenu+=`Environnement : ${environnement}\n`;
  contenu+='\n== Identification du client ==\n\n';
  if(client)contenu+=`Client : ${client}\n`;
  if(accesSupportUtilisateur)contenu+=`Accès support Utilisateur : ${accesSupportUtilisateur}\n`;
  if(accesServiceUser)contenu+=`Accès service user : ${accesServiceUser}\n`;
  contenu+='\n== Anomalie ==\n\n';
  if(descriptionProblematique)contenu+=`Description de la problématique :\n${descriptionProblematique}\n\n`;
  if(besoinClient)contenu+=`Besoin client : ${besoinClient}\n\n`;
  if(dateApparitionProbleme||dateApparitionProblemeLibre){
    let dateToShow=dateApparitionProblemeLibre;
    if(dateApparitionProbleme){
      const d=new Date(dateApparitionProbleme);
      dateToShow=`${String(d.getDate()).padStart(2,'0')}/${String(d.getMonth()+1).padStart(2,'0')}/${d.getFullYear()}`;
    }
    contenu+=`Date d'apparition du problème : ${dateToShow}\n\n`;
  }
  if(idLongOkArray.length>0){
    contenu+='ID Long OK :\n';
    idLongOkArray.forEach(id=>{contenu+=`- ${id}\n`;});
    contenu+='\n';
  }
  if(idLongNokArray.length>0){
    contenu+='ID Long NOK :\n';
    idLongNokArray.forEach(id=>{contenu+=`- ${id}\n`;});
    contenu+='\n';
  }
  contenu+='== Analyse et Actions ==\n\n';
  if(analyseActions)contenu+=`${analyseActions}\n`;
  qs('#contenu_previsualisation').textContent=contenu;
};window.genererFichier=function(){const contenu=document.getElementById('contenu_previsualisation').textContent;if(contenu.trim()==='Remplissez le formulaire et cliquez sur "Prévisualiser" pour voir le résultat ici.')return alert("Veuillez d'abord prévisualiser le contenu avant de télécharger.");const date=new Date(),dateStr=`${date.getFullYear()}-${String(date.getMonth()+1).padStart(2,'0')}-${String(date.getDate()).padStart(2,'0')}`,clientInfo=document.getElementById('client').value||'client',filename=`escalade_${clientInfo.replace(/\s+/g,'_')}_${dateStr}.txt`,blob=new Blob([contenu],{type:'text/plain'}),lien=document.createElement('a');lien.href=URL.createObjectURL(blob);lien.download=filename;lien.click();};window.copierDansPressePapier=function(){const contenu=document.getElementById('contenu_previsualisation').textContent;if(contenu.trim()==='Remplissez le formulaire et cliquez sur "Prévisualiser" pour voir le résultat ici.')return alert("Veuillez d'abord prévisualiser le contenu avant de copier.");navigator.clipboard.writeText(contenu).then(()=>{const statusElem=document.getElementById('copy_status');statusElem.textContent='Contenu copié dans le presse-papiers !';statusElem.style.display='block';setTimeout(()=>{statusElem.style.display='none';},3000);}).catch(err=>{console.error('Erreur lors de la copie: ',err);alert('Erreur lors de la copie. Vérifiez les paramètres de votre navigateur.');});};window.ajouterChamp=function(type){const containerId=type==='ok'?'id_long_ok_container':'id_long_nok_container',container=document.getElementById(containerId),index=container.children.length+1,wrapper=document.createElement('div');wrapper.className='id-input-wrapper';const input=document.createElement('input');input.type='text';input.name=type==='ok'?'id_long_ok[]':'id_long_nok[]';input.className=type==='ok'?'id-long-ok':'id-long-nok';input.setAttribute('aria-label',`ID Long ${type.toUpperCase()} ${index}`);const removeBtn=document.createElement('button');removeBtn.type='button';removeBtn.className='remove-id-btn';removeBtn.innerHTML='×';removeBtn.setAttribute('aria-label',`Supprimer ID Long ${type.toUpperCase()} ${index}`);removeBtn.onclick=function(){window.supprimerChamp(this);};wrapper.appendChild(input);wrapper.appendChild(removeBtn);container.appendChild(wrapper);input.focus();};window.supprimerChamp=function(btn){const wrapper=btn.parentElement,container=wrapper.parentElement;if(container.children.length<=1){const input=wrapper.querySelector('input');input.value='';input.focus();return;}container.removeChild(wrapper);};window.reinitialiserFormulaire=function(){if(confirm("Êtes-vous sûr de vouloir réinitialiser le formulaire ?")){document.getElementById('formulaire').reset();document.getElementById('contenu_previsualisation').textContent='Remplissez le formulaire et cliquez sur "Prévisualiser" pour voir le résultat ici.';resetIdContainer('id_long_ok_container','id-long-ok','id_long_ok[]');resetIdContainer('id_long_nok_container','id-long-nok','id_long_nok[]');}};function resetIdContainer(containerId,className,inputName){const container=document.getElementById(containerId);container.innerHTML='';const wrapper=document.createElement('div');wrapper.className='id-input-wrapper';const input=document.createElement('input');input.type='text';input.name=inputName;input.className=className;const removeBtn=document.createElement('button');removeBtn.type='button';removeBtn.className='remove-id-btn';removeBtn.innerHTML='×';removeBtn.title='Supprimer';removeBtn.onclick=function(){window.supprimerChamp(this);};wrapper.appendChild(input);wrapper.appendChild(removeBtn);container.appendChild(wrapper);}
})();
    </script>
	<script>
  document.addEventListener('DOMContentLoaded', () => {
    const splash = document.getElementById('splash-screen');
    const lastShown = localStorage.getItem('splashDate');
    const today = new Date().toISOString().slice(0, 10); // ex: "2025-06-04"

    if (lastShown === today) {
      // Masquer immédiatement si déjà vu aujourd'hui
      splash.style.display = 'none';
    } else {
      // Sinon, afficher puis masquer après 2.5 secondes
      splash.style.display = 'flex';
      setTimeout(() => {
        splash.style.display = 'none';
        localStorage.setItem('splashDate', today);
      }, 2500);
    }
  });
</script>

</body>
</html>
